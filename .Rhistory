df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
data
for(i in colnames(df)){
v <- as.vector(unlist(df$i))
vr <- diff(v)/(v[-length(v)])
data$i <- vr
}
nrow(data)
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
nrow(data)
for(i in colnames(df)){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data$i <- vr
}
for(i in colnames(df)[1]){
v <- as.vector(unlist(df$i))
vr <- diff(v)/(v[-length(v)])
print(vr)
}
colnames(df)[1]
for(i in colnames(df)[2]){
v <- as.vector(unlist(df$i))
vr <- diff(v)/(v[-length(v)])
print(vr)
}
print(i)
print(df[i])
df <- read.csv("Stocks1.csv")
head(df)
for(i in colnames(df)[2]){
print(df[i])
}
for(i in colnames(df)[2]){
print(as.vector(unlist(df[i])))
}
for(i in colnames(df)[3]){
print(as.vector(unlist(df[i])))
}
for(i in colnames(df)[1]){
print(as.vector(unlist(df[i])))
}
df <- read.csv("Stocks1.csv")
head(df)
for(i in colnames(df)[2]){
v <- as.vector(unlist(df[i]))
print(v)
}
print(diff(v)/(v[-length(v)]))
for(i in colnames(df)){
v <- as.vector(unlist(df[i]))
print(diff(v)/(v[-length(v)]))
}
for(i in colnames(df)[2]){
v <- as.vector(unlist(df[i]))
print(diff(v)/(v[-length(v)]))
}
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data$i <- vr
}
data
for(i in colnames(df)[2]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
data
for(i in colnames(df)[2:4]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
data
for(i in colnames(df)[1:]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
for(i in colnames(df)){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
for(i in colnames(df)){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
for(i in colnames(df)){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
for(i in colnames(df)[2:4]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
data
colnames(df)
colnames(df)[2:4]
class(colnames(df))
class(colnames(df[2:4]))
colnames(df)[1:]
colnames(df)[2:length(colnames(df))]
for(i in colnames(df)[2:length(colnames(df))]{
for(i in colnames(df)[2:length(colnames(df))]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
data
library(dplyr)
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
head(data)
data
cor(data)
rownames(data) <- df$Date
rownames(data) <- data$Date
head(data)
data$Date <- NULL
head(data)
cor(data)
corr <- cor(data)
avg(data)
mean(data)
mean(data$AAPL)
rets <- c()
for(i in colnames(data)[1:length(colnames(df))]){
m <- mean(data$i)
rets <- c(rets, m)
}
for(i in colnames(data)[1:length(colnames(df))]){
m <- mean(data[i])
rets <- c(rets, m)
}
for(i in colnames(data)[1]{
for(i in colnames(data)[1]){
m <- mean(data[i])
print(m)
}
for(i in colnames(data)[1]){
mean(data[i])
}
print(i)
for(i in colnames(data)[1]){
print(i)
}
print(mean(data[i]))
data
mean(data["AAPL"])
mean(data$AAPL)
for(i in colnames(data)[1]){
print(mean(data$AAPL))
}
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v <- as.vector(unlist(df[i]))
vr <- diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(df))]){
m <- mean(data$i)
rets <- c(rets, m)
}
for(i in colnames(data)[1]){
print(mean(data$AAPL))
}
for(i in colnames(data)[1:length(colnames(df))]){
print(mean(data$i))
}
for(i in colnames(data)[1:5)]){
print(mean(data$i))
}
for(i in colnames(data)[1:5])){
print(mean(data$i))
}
for(i in colnames(data)[1:5]){
print(mean(data$i))
}
for(i in colnames(data)[1]){
print(mean(data$i))
}
for(i in colnames(data)[1]){
print(mean(data$i))
}
for(i in colnames(data)[1]){
print(mean(data[i]))
}
for(i in colnames(data)[1]){
print(data[i])
}
for(i in colnames(data)[1]){
print(data[i][1])
}
for(i in colnames(data)[1]){
print(meann(data[i][1]))
}
for(i in colnames(data)[1]){
print(mean(data[i][1]))
}
for(i in colnames(data)[1]){
print(data[i][1])
}
data["AAPL"]
mean(data["AAPL"])
for(i in colnames(data)[1]){
print(data$i)
}
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1]){
v <- as.vector(unlist(df[i]))
print(v)
}
mean(v)
for(i in colnames(data)[1]){
v <- as.vector(unlist(data[i]))
print(v)
}
for(i in colnames(data)[1]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets
corr
class(corr)
rets <- matrix(rets)
names(rets) <- c(colnames(data))
rets
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rets
rownames(rets) <- colnames(data)
rets
colnames(rets) <- ("Returns")
rets
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
rets
corr
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
library(dplyr)
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
rets
corr
library(dplyr)
###############Importing dataset####################################################
df <- read.csv("Stocks1.csv")
head(df)
###############Transforming Prices to returns#######################################
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
###############Calculating Returns and Covariance Matrix#############################
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
################Current stock returns################################################
s0 <- data[-1]
s0 <- data[-1]
s0
s0 <- data[nrow(data)]
s0 <- data[1]
s0
s0 <- data %>% slice(nrow(data))
s0
data
s0
nrow(data)
data %>% slice(252)
data %>% slice(253)
data %>% slice(1)
head(data,1)
tail(data,1)
data %>% slice(252)
s0 <- matrix(data %>% slice(nrow(data)))
s0
matrix(df %>% slice(nrow(df)))
matrix(df %>% slice(nrow(df)))[-1]
View(df)
library(dplyr)
###############Importing dataset####################################################
df <- read.csv("Stocks1.csv")
head(df)
###############Transforming Prices to returns#######################################
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
###############Calculating Returns and Covariance Matrix#############################
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
################Current stock returns################################################
df$Date <- NULL
s0 <- matrix(df %>% slice(nrow(df)))
rownames(s0) <- colnames(data)
colnames(s0) <- ("Current Prices")
s0
source("gbm.r")
source("stock.r")
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
Adj_CVaR <- c()
alfa <- 0.01
nsim <- 100
for(i in c(1:nsim)){
Adjusted_CVaR <- CVaR_Function(rets, sigmas, cdcorr, s0, alfa)
Adj_CVaR <- c(Adj_CVaR, Adjusted_CVaR)
}
Final_AdjCVaR <- -mean(Adj_CVaR)*100
#######Final Results
Final_AdjCVaR
setwd("C:/Users/LorenzoFancelli/Desktop/My APP")
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
Adj_CVaR <- c()
alfa <- 0.01
nsim <- 100
for(i in c(1:nsim)){
Adjusted_CVaR <- CVaR_Function(rets, sigmas, cdcorr, s0, alfa)
Adj_CVaR <- c(Adj_CVaR, Adjusted_CVaR)
}
Final_AdjCVaR <- -mean(Adj_CVaR)*100
#######Final Results
Final_AdjCVaR
nsim <- 10
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
Adj_CVaR <- c()
alfa <- 0.01
nsim <- 10
for(i in c(1:nsim)){
Adjusted_CVaR <- CVaR_Function(rets, sigmas, cdcorr, s0, alfa)
Adj_CVaR <- c(Adj_CVaR, Adjusted_CVaR)
}
Final_AdjCVaR <- -mean(Adj_CVaR)*100
#######Final Results
Final_AdjCVaR
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
Adj_CVaR <- c()
alfa <- 0.01
nsim <- 10
for(i in c(1:nsim)){
Adjusted_CVaR <- CVaR_Function(rets, sigmas, cdcorr, s0, alfa)
Adj_CVaR <- c(Adj_CVaR, Adjusted_CVaR)
}
Final_AdjCVaR <- -mean(Adj_CVaR)*100
#######Final Results
Final_AdjCVaR
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
Adj_CVaR <- c()
alfa <- 0.05
nsim <- 10
for(i in c(1:nsim)){
Adjusted_CVaR <- CVaR_Function(rets, sigmas, cdcorr, s0, alfa)
Adj_CVaR <- c(Adj_CVaR, Adjusted_CVaR)
}
Final_AdjCVaR <- -mean(Adj_CVaR)*100
#######Final Results
Final_AdjCVaR
