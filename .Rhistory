chol(corr)
library(dplyr)
df <- read.csv("Stocks1.csv")
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
for(i in colnames(df)[2:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
corr <- cor(data)
rets <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
df$Date <- NULL
s0 <- matrix(df %>% slice(nrow(df)))
rownames(s0) <- colnames(data)
colnames(s0) <- ("Current Prices")
chol(corr)
cdcorr_t <- chol(corr)
cdcorr <- t(cdcorr_t)
cdcorr
corr
cdcorr %*% cdcorr_t
cdcorr %*% cdcorr_t == corr
n = 1000 # number of simulations
normvars <- rnorm(1000)
normvars
normvars <- rnorm(length(corr))
normvars
normvars <- rnorm(nrows(corr))
normvars
normvars <- rnorm(nrow(corr))
normvars
cdcorr %*% normvars
cdcorr_t %*% normvars
cdcorr
corrWiener <- cdcorr%*% normvars
corrWiener
cdcorr
normvars
