source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
nsimul <- 10000
alfa <- 0.001
weights <- c(0,0,1,0,0)
nsim_CVaR <- 10
Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, weights, nsim_CVaR)
rw <- RWgenerators(1000, 5)
r
rw
rw[1,]
nsimul <- 10000
alfa <- 0.001
#weights <- c(0,0,1,0,0)
nsim_CVaR <- 10
rets
sigmas
cdcorr
s0
alfa
weights
nsim_CVaR
rw <- RWgenerators(1000, 5)
ESWeights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[1,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
}
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
nsimul <- 10000
alfa <- 0.001
nsim_CVaR <- 10
rw <- RWgenerators(10, 5)
ESWeights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[1,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
}
ESweights
ESWeights
rw
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(10, 5)
ESWeights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[1,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
}
ESWeights
s0
s0
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
s0
s0*rw
rw <- RWgenerators(100, 5)
alfa <- 0.05
nsim_CVaR <- 10
s0 * rw
rw
s0 * rw[1,]
s0 * as.matrix(rw)
as.matrix(s0) * rw[1,]
s0 * as.matrix(rw[1,])
as.matrix(s0) * as.matrix(rw[1,])
as.matrix(s0)
as.matrix(s0[1])
as.matrix(s0["Curret Prices"])
s0
rw
rw[1,]
s0
rw[1,]*10
s0 *10
as.numeric(s0)*10
as.numeric(s0) * rw[1,]
rets * rw[1,]
rets
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(100, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[1,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- rets * rw[1,]
retsweights <- c(retsweights, rs)
}
retsweights
rets*rw[1,]
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(100, 5)
ESWeights <- c()
retsweights <- c()
rets * rw[1,]
sum(rets*rw[1,])
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(100, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- sum(rets * rw[i,])
retsweights <- c(retsweights, rs)
}
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(100, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- sum(rets * rw[i,])
retsweights <- c(retsweights, rs)
}
retsweights
ESWeights
retsweights
ESWeights
retsweights*100
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(100, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
}
rets
retsweights
ESWeights
plot(ESWeights, retsweights)
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(1000, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
}
plot(ESWeights, retsweights)
min(ESWeights)
which(ESweights == min(ESWeights))
which(ESweights == min(ESweights))
min(ESWeights)
m <- min(ESWeights)
which(ESWeights == m)
rw[719,]
source("gbm.r")
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(10, 5)
ESWeights <- c()
retsweights <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
}
m <- min(ESWeights)
pos_min <- which(ESWeights == m)
MIN_CVaR_Portfolio <- rw[pos_min, ]
plot(ESWeights, retsweights)
print(MIN_CVaR_Portfolio)
library(quantmod)
df <- c()
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = "2021-05-03",
to = "2022-05-02",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
library(quantmod)
TKs <- c("AAPL", "MSFT", "TSLA", "GOOG")
df <- c()
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = "2021-05-03",
to = "2022-05-02",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
getSymbols("QQQ;SPY", from="1997-12-31", src='yahoo')
getSymbols("QQQ;SPY", from="1997-12-31", src='yahoo')
Cl(QQQ)
qqq.data <- getSymbols("QQQ", auto.assign=FALSE, from="1997-12-31", src='yahoo')
getSymbols(c("QQQ,SPY"), from="1997-12-31", src='yahoo')
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR")
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
myStocks <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
FirstS
df <- c()
df <- data.frame(FirstS)
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
df
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- data.frame(FirstS[4])
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
df
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
from <- "2021-05-03"
GetStocks <- function(TKS, from){
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- data.frame(FirstS[4])
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = "2021-05-03",
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
}
GetStocks(TKs, from)
GetStocks(TKs, from)
df <- GetStocks(TKs, from)
df
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
library(quantmod)
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
GetStocks <- function(TKS, start){
FirstS <-as.data.frame(lapply(TKs[1], function(x) {getSymbols(x,
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
df <- data.frame(FirstS[4])
for(i in TKs[2:length(TKs)]){
myStocks2 <-as.data.frame(lapply(i, function(x) {getSymbols(x,
from = start,
periodicity = "daily",
auto.assign=FALSE)} ))
df <- cbind(df, myStocks2[4])
}
df
}
GetStocks(TKs, start)
library(dplyr)
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
head(df)
data <- data.frame(df["Date"])
data <- slice(data, 1:(n()-1))
data <- data.frame(df["Date"])
df
library(dplyr)
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
head(df)
data <- data.frame(c(1:nrow(df)-1))
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
library(dplyr)
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
head(df)
data <- data.frame(c(2:nrow(df)-1))
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
rownames(data) <- data$Date
data$Date <- NULL
head(data)
colnames(data) <- TKs
head(data)
corr <- cor(data)
rets <- c()
sigmas <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
sigmas <- c(sigmas, sd(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
data
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
head(df)
ncol(df)
data <- data.frame(c(2:nrow(df)-1))
data
library(dplyr)
head(df)
data <- data.frame(c(2:nrow(df)-1))
colnames(data) <- "To_remove"
for(i in colnames(df)[1:length(colnames(df))]){
v = as.vector(unlist(df[i]))
vr = diff(v)/(v[-length(v)])
data[i] <- vr
}
#rownames(data) <- data$Date
data$To_remove <- NULL
colnames(data) <- TKs
head(data)
corr <- cor(data)
rets <- c()
sigmas <- c()
for(i in colnames(data)[1:length(colnames(data))]){
v <- as.vector(unlist(data[i]))
rets <- c(rets, mean(v))
sigmas <- c(sigmas, sd(v))
}
rets <- matrix(rets)
rownames(rets) <- colnames(data)
colnames(rets) <- ("Returns")
sigmas <- matrix(sigmas)
rownames(sigmas) <- colnames(data)
colnames(sigmas) <- ("Standard Deviations")
df$Date <- NULL
s0 <- matrix(df[nrow(df),])
rownames(s0) <- colnames(data)
colnames(s0) <- ("Current Prices")
cdcorr_t <- chol(corr)
cdcorr <- t(cdcorr_t)
cdcorr %*% cdcorr_t
print(cdcorr)
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
rw <- RWgenerators(10, 5)
ESWeights <- c()
retsweights <- c()
Sharpe <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
sh <- rs-ES
Sharpe <- c(Sharpe, sh)
print(length(ESWeights))
}
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(10, 5)
ESWeights <- c()
retsweights <- c()
Sharpe <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
sh <- rs-ES
Sharpe <- c(Sharpe, sh)
print(length(ESWeights))
}
source("gbm.r")
source("impstocks.r")
TKs <- c("^GSPC", "EEM", "VGK", "SPMO", "IJR", "AIA")
start <- "2021-05-03"
df <- GetStocks(TKs, start)
source("stock.r")
source("AdjustedCVaRProcedure.r")
source("AdjCVaRF.r")
source("randomPortfolios.r")
library(ggplot2)
alfa <- 0.05
nsim_CVaR <- 10
rw <- RWgenerators(10, length(TKs))
ESWeights <- c()
retsweights <- c()
Sharpe <- c()
for(i in c(1:nrow(rw))){
ES <- Final_AdjCVaR_Function(rets, sigmas, cdcorr, s0, alfa, rw[i,], nsim_CVaR)
ESWeights <- c(ESWeights, ES)
rs <- (sum(rets * rw[i,]))*100
retsweights <- c(retsweights, rs)
sh <- rs-ES
Sharpe <- c(Sharpe, sh)
print(length(ESWeights))
}
m <- min(ESWeights)
pos_min <- which(ESWeights == m)
MIN_CVaR_Portfolio <- rw[pos_min, ]
ma <- max(Sharpe)
pos_max <- which(Sharpe == ma)
MAX_SH_Portfolio <- rw[pos_max, ]
plot(ESWeights, retsweights)
print(MIN_CVaR_Portfolio)
print(MAX_SH_Portfolio)
